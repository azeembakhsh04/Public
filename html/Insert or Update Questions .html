<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Question Answer App</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f2f2f2;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  
  .container {
    width: 400px;
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    padding: 20px;
  }

  input[type="text"], textarea, input[type="file"], input[type="radio"] {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
 textarea {
   height: auto;
  }

  button {
    background-color: #4CAF50;
    color: #fff;
    border: none;
    border-radius: 5px;
    padding: 10px 20px;
    cursor: pointer;
  }

  button:hover {
    background-color: #45a049;
  }

  .answer {
    margin-top: 20px;
  }

  .hint {
    margin-top: 10px;
    font-size: 12px;
    color: #999;
  }
 .radio-group {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  .radio-label {
      margin-right: 5px; /* Adjust the right margin as needed */
   }

input[type="radio"] {
  margin-right: 5px; /* Adjust the right margin as needed */
}


  #pushIdInput {
    display: none; /* Hide push ID input by default */
  }


</style>
</head>
<body>
  
<div class="container">
  <h2>Question Answer App</h2>
 <div class="radio-group">
  <input type="radio" id="insertRadio" name="action" value="insert" checked>
  <label class="radio-label" for="insertRadio">Insert</label>
  <input type="radio" id="updateRadio" name="action" value="update">
  <label class="radio-label" for="updateRadio">Update</label>
</div>
  <input type="text" id="questionInput" placeholder="Enter your question">
  <textarea id="answerInput" placeholder="Enter the answer"></textarea>
  <input type="text" id="pushIdInput" placeholder="Enter push ID (optional)">
  <button id="submitButton">Submit</button>
  <div class="answer" id="answer"></div>
  <div class="hint" id="hint"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
  import { getDatabase, push, ref, onValue, set, get } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";
  import { getStorage, ref as storageRef, uploadBytes } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-storage.js";

  let firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "azeem-tech.firebaseapp.com",
    databaseURL: "https://azeem-tech-default-rtdb.firebaseio.com",
    projectId: "azeem-tech",
    storageBucket: "azeem-tech.appspot.com",
    messagingSenderId: "362146826134",
    appId: "1:362146826134:web:5003ae07ff2f0cef14ffb7",
    measurementId: "G-VKP3KD919K"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase();
  const storage = getStorage();
  var rodio = document.getElementById("updateRadio");
  
  setInterval(function(){
   var pushIdInput = document.getElementById("pushIdInput");
  if (rodio.checked) {
    pushIdInput.style.display = "block"; // Show push ID input when "Update Question" is checked
  } else {
    pushIdInput.style.display = "none"; // Hide push ID input otherwise
  }
  }, 100)
  
  document.getElementById('submitButton').addEventListener('click', storeQuestion)


 function storeQuestion() {
    const question = document.getElementById("questionInput").value.trim();
    const answer = document.getElementById("answerInput").value.trim();
    const inputPushId = document.getElementById("pushIdInput").value.trim();
    let pushId;
    if(question.toLowerCase() !== 'developer') {
        pushId = '-' + inputPushId;
     } else {
      alert("To ensure the security and integrity of the stored value on Firebase, the developer has implemented security measures to prevent unauthorized modifications to the specified tag.")
        pushId = 'non';
    }
    const action = document.querySelector('input[name="action"]:checked').value;

    if (question !== "" && answer !== "") {
        if (action === "insert") {
            checkQuestionExists(question, answer);
        } else if (action === "update") {
            if (pushId !== "") {
                checkQuestionMatch(pushId, question, answer);
            } else {
                document.getElementById("hint").innerText = "Please enter a valid push ID!";
            }
        }
    } else {
        document.getElementById("hint").innerText = "Please enter both question and answer!";
    }
}

function checkQuestionExists(question, answer) {
    onValue(ref(db, 'questions'), (snapshot) => {
        const data = snapshot.val();
        for (const key in data) {
            if (data[key].question.toLowerCase() === question.toLowerCase()) {
                document.getElementById("hint").innerText = "This question is already stored! Question ID: " + key ;
                return;
            }
        }
        addNewQuestion(question, answer);
    });
}

function checkQuestionMatch(pushId, question, answer) {
    onValue(ref(db, 'questions'), (snapshot) => {
        const data = snapshot.val();
        let questionId = null;
        for (const key in data) {
            if (data[key].question.toLowerCase() === question.toLowerCase()) {
                questionId = key;
                break;
            }
        }

        if (questionId) {
            if (questionId == pushId) {
                updateQuestion(pushId, answer);
            } else {
                document.getElementById("hint").innerText = "Provided push ID does not match the question!";
            }
        } else {
            document.getElementById("hint").innerText = "Question does not exist in the database!";
        }
    });
}



function addNewQuestion(question, answer) {
    const newQuestionRef = push(ref(db, 'questions'));
    const newQuestionId = newQuestionRef.key;

    set(newQuestionRef, {
        question: question,
        answer: answer
    }).then(() => {
        document.getElementById("hint").innerText = "Question added successfully!";
        document.getElementById("hint").innerText += "\nQuestion ID: " + newQuestionId;
    }).catch((error) => {
        console.error("Error adding question:", error);
        document.getElementById("hint").innerText = "Error adding question!";
    });
}

function updateQuestion(pushId, answer) {
    set(ref(db, 'questions/' + pushId + '/answer'), answer)
        .then(() => {
            document.getElementById("hint").innerText = "Question updated successfully!";
            document.getElementById("hint").innerText += "\nQuestion ID: " + pushId;
        })
        .catch((error) => {
            console.error("Error updating question:", error);
            document.getElementById("hint").innerText = "Error updating question!";
        });
}

</script>
</body>
</html>
